# Change: 添加配置迁移功能的测试覆盖

## Why

配置迁移功能（从 `settings.json` 到 `ccc.json`）已经在 main.go:104-178 实现，包括三个核心函数：
- `checkExistingSettings()`: 检查旧配置是否存在
- `promptUserForMigration()`: 提示用户确认迁移
- `migrateFromSettings()`: 执行迁移逻辑

但是目前缺少测试覆盖，无法验证：
- 迁移逻辑的正确性（env 字段拆分、settings 保留）
- 边缘情况处理（空配置、缺少 env、格式错误）
- 用户交互流程（接受/拒绝迁移）
- 并发安全和文件操作的原子性

为了保证代码质量和避免手工测试，需要添加完善的单元测试和集成测试。

## What Changes

- **新增测试文件**: 创建 `main_test.go`，覆盖配置迁移相关功能
- **重构现有代码**: 提取可测试的纯函数，改善依赖注入
  - 将用户输入提示逻辑抽象为可注入的函数
  - 将文件系统操作封装为可 mock 的接口
- **测试覆盖范围**:
  - 单元测试：测试各个函数的逻辑正确性
  - 集成测试：测试完整迁移流程
  - 边缘情况：空配置、格式错误、文件权限问题

## Impact

- 影响的规范: `config-migration`（新增）
- 影响的代码:
  - `main.go:104-178` - 可能需要轻微重构以提高可测试性
  - 新增 `main_test.go` - 包含所有测试用例
- 向后兼容性: ✅ 完全兼容，仅添加测试，不修改业务逻辑

## Migration Notes

无需迁移，纯测试添加。
