# 实现方案：[功能名称]

**分支**: `[###-feature-name]` | **日期**: [DATE] | **规格**: [链接]
**输入**: 来自 `/specs/[###-feature-name]/spec.md` 的功能规格

**注意**: 本模板由 `/speckit.plan` 命令填充。详见 `.specify/templates/commands/plan.md` 中的执行工作流。

## 特别说明：使用中文

**本文档必须使用中文编写。**

1. 所有技术描述、架构决策、实现细节必须使用中文。
2. 代码示例中的注释必须使用中文。
3. 变量名、函数名等标识符使用英文，但说明文字使用中文。

## 摘要

[从功能规格中提取：主要需求 + 技术方案摘要]

## 技术上下文

<!--
  行动要求：用本功能的技术细节替换本节内容。
  此处的结构以顾问形式呈现，用于指导迭代过程。
-->

**语言/版本**: [例如：Go 1.21、Python 3.11、Swift 5.9 或 需要澄清]
**主要依赖**: [例如：标准库、特定框架 或 需要澄清]
**存储**: [如适用，例如：JSON 文件、配置文件 或 不适用]
**测试**: [例如：go test、pytest 或 需要澄清]
**目标平台**: [例如：Linux 服务器、macOS、CLI 工具 或 需要澄清]
**项目类型**: [single/web/mobile - 决定源代码结构]
**性能目标**: [领域特定，例如：启动时间 <100ms、内存占用 <50MB 或 需要澄清]
**约束**: [领域特定，例如：单二进制、静态链接、跨平台 或 需要澄清]
**规模/范围**: [领域特定，例如：<1000 行代码、单个可执行文件 或 需要澄清]

## 宪章检查

*门禁：必须在第 0 阶段研究前通过。第 1 阶段设计后再次检查。*

### ccc 项目宪章合规检查

- [ ] **原则一：单二进制分发** - 最终产物是单一静态链接二进制文件
- [ ] **原则二：代码质量标准** - 符合 gofmt、go vet 要求
- [ ] **原则三：测试规范** - 包含单元测试和竞态检测
- [ ] **原则四：向后兼容** - 配置格式变更保持兼容
- [ ] **原则五：跨平台支持** - 支持 darwin/linux, amd64/arm64
- [ ] **原则六：错误处理与可观测性** - 错误明确且可操作

### 复杂度跟踪

> **仅当宪章检查有违规需要 justify 时填写**

| 违规项 | 为何需要 | 被拒绝的更简单方案及原因 |
|--------|----------|--------------------------|
| [例如：引入外部依赖] | [当前需求] | [为何标准库不足] |

## 项目结构

### 文档组织（本功能）

```text
specs/[###-feature]/
├── plan.md              # 本文件 (/speckit.plan 命令输出)
├── research.md          # 第 0 阶段输出 (/speckit.plan 命令)
├── data-model.md        # 第 1 阶段输出 (/speckit.plan 命令)
├── quickstart.md        # 第 1 阶段输出 (/speckit.plan 命令)
├── contracts/           # 第 1 阶段输出 (/speckit.plan 命令)
└── tasks.md             # 第 2 阶段输出 (/speckit.tasks 命令 - 非由 /speckit.plan 创建)
```

### 源代码组织（仓库根目录）

<!--
  行动要求：用具体布局替换下方的占位符树。
  删除未使用的选项并使用真实路径扩展所选结构（例如：internal/、cmd/、pkg/）。
  交付的方案不应包含选项标签。
-->

```text
# [如不使用则删除] 选项 1: 单一 Go 项目 (ccc 默认)

cmd/ccc/              # 主入口
├── main.go

internal/             # 私有应用代码
├── cli/              # CLI 命令处理
├── config/           # 配置管理
├── provider/         # 提供商切换逻辑
└── supervisor/       # Supervisor 模式

pkg/                  # 可被外部导入的公共代码（如有）
└── ...

tests/                # 测试文件
├── unit/             # 单元测试
├── integration/      # 集成测试
└── e2e/              # 端到端测试
```

**结构决策**: [记录所选结构并引用上面捕获的真实目录]

## 实现阶段

### 第 -1 阶段：预实现门禁

> **重要：在开始任何实现工作前必须通过此阶段**

#### 宪章合规门禁

- [ ] 所有 6 条核心原则已检查
- [ ] 如有违规，已在"复杂度跟踪"表中记录理由

#### 技术决策门禁

- [ ] 技术栈已确定（语言、依赖）
- [ ] 项目结构已定义
- [ ] 数据模型已设计（如适用）
- [ ] API 契约已定义（如适用）

---

### 第 0 阶段：技术研究

**目标**: 调研技术选项，收集实现所需信息

**输出**: `research.md`

**研究内容**（根据功能选择相关项）:
- [ ] 可用的 Go 标准库和第三方包
- [ ] 配置文件格式和解析方案
- [ ] CLI 框架选择（cobra、urfave/cli 等）
- [ ] 测试框架和 Mock 工具
- [ ] 跨平台兼容性考虑

---

### 第 1 阶段：架构设计

**目标**: 定义数据模型、API 契约和实现细节

**输出**: `data-model.md`、`contracts/`、`quickstart.md`

**数据模型** (data-model.md):
- [ ] 定义核心数据结构
- [ ] 定义配置格式
- [ ] 定义错误类型

**API 契约** (contracts/):
- [ ] CLI 命令接口
- [ ] 配置文件格式
- [ ] 错误处理契约

**快速入门** (quickstart.md):
- [ ] 关键验证场景
- [ ] 测试检查清单

---

### 第 2 阶段：任务分解

**目标**: 将设计转化为可执行的任务列表

**输出**: `tasks.md` (由 `/speckit.tasks` 命令生成)

> **注意**: 第 2 阶段不在此方案中完成，由独立的 `/speckit.tasks` 命令处理

---

## 实施文件创建顺序

> **重要：按照此顺序创建文件以确保质量**

1. **contracts/** - 首先定义 API 契约和接口
2. **测试文件** - 按以下顺序创建：
   - contract/ - 契约测试
   - integration/ - 集成测试
   - e2e/ - 端到端测试
   - unit/ - 单元测试
3. **源代码文件** - 创建使测试通过的实现

**理由**: 测试先行确保 API 设计可用，实现符合需求。

---

## 复杂度跟踪

> **仅当宪章检查有违规需要 justify 时填写**

| 违规项 | 为何需要 | 被拒绝的更简单方案及原因 |
|--------|----------|--------------------------|
| | | |
